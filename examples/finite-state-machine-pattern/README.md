# 状态模式 State Pattern

## What?
状态模式的定义是：
> 允许一个对象在其内部状态改变时改变它的行为，对象看起来似乎修改了它的类。

状态模式是状态机的实现之一，但在 JavaScript 这种“无类”语言中，没有规定让状态对象一定要从类中创建而来。
另外一点，JavaScript 可以非常方便地使用委托技术，并不需要事先让一个对象持有另一个对象。

## Why?
在许多功能逻辑的实现中，我们常常会发现，某些类（功能）具有一组特定的状态并且伴随这特定的状态转变规则，比如对于一个电灯来说，它有开和关两种状态，开只能转变为关，关只能转变为开；再或者，一个上传文件的控件，它常常有等待上传、上传中、上传成功、上传失败这几种状态，而且其状态的转变也是有固定的顺序；如果是按照面向过程的方式，可能我们存在大量的 `if else` 判断其状态，来进行对应的状态转换；通过状态模式，可以减少许多条件判断，且让状态转换的流程清晰易懂，便于维护；并且在需要增加新状态，更容易拓展。

## Wow!

### Demo: 临床病历业务状态流转流程

#### 状态

- 待提交
- 待审签
- 已审签
- 审签退回
- 已打印

对于临床病历来说，有 `待提交` 、`待审签`、`已审签`、`审签退回`、`已打印` 这几种状态，流转的规则是：

普通医生权限：
- `待提交` 进入下一个状态为 `待审签`，进入上一个状态时保持不变
- `待审签` 进入下一个状态为 `已审签`，进入上一个状态为 `待提交` 
- `已审签` 进入下一个状态为 `已打印`，进入上一个状态为 `审签退回` 
- `审签退回` 进入下一个状态为 `已审签`，进入上一个状态为 `待提交` 
- `已打印` 进入下一个状态时保持不变，进入上一个状态时保持不变 

高级医生权限：
- `待提交` 进入下一个状态为 `已审签`，进入上一个状态时保持不变
- 其他的与普通医生一致

[临床病历业务状态流转流程 Clinical medical record states transfer flow](./index.js): 
